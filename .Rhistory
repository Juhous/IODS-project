gather(., key = "var", value = "value", -c(crim, clust)) %>%
ggplot(aes(value, crim, color = clust)) +
geom_point(shape = 1, size = 1.5, stroke = 1, alpha = .3) +
facet_wrap(~var, scales = "free_x")
multiplot(p1,p2, cols = 2)
p1
corrplot(cor(df), method = "pie", type = "upper")
p1
p1 <- grab_grob()
p1
grid.grab()
grab_grob <- function(){
gridGraphics::grid.echo()
grid.grab()
}
p1 <- grab_grob()
p1<- recordPlot()
p2 <- df %>% mutate(clust = factor(km$cluster)) %>%
gather(., key = "var", value = "value", -c(crim, clust)) %>%
ggplot(aes(value, crim, color = clust)) +
geom_point(shape = 1, size = 1.5, stroke = 1, alpha = .3) +
facet_wrap(~var, scales = "free_x")
multiplot(p1,p2, cols = 2)
corrplot(cor(df), method = "pie", type = "upper")
p1 <- recordPlot()
p1
class(p1)
p2
p1
multiplot(p1,p2, cols = 2)
multiplot(p1, p1, cols = 2)
multiplot(p2, p2, cols = 2)
p2 <- qplot(df$crim, df$zn)
p1 <- qplot(df$zn, df$zn)
p2 <- qplot(df$crim, df$zn)
p1 <- qplot(df$zn, df$zn)
multiplot(p2, p2, cols = 2)
corrplot(cor(df), method = "pie", type = "upper")
corrplot(cor(df), method = "pie", type = "upper")
source("helper_functions.R")
library(magrittr)
library(GGally)
library(ggplot2)
library(stringr)
library(tidyr)
library(MASS)
library(knitr)
library(kableExtra)
library(corrplot)
library(plotly)
library(dplyr)
data("Boston")
df <- Boston %>% tbl_df
df %<>% mutate_at(vars(-chas), funs(scale)) %>%
mutate_at(vars(-chas), funs(as.vector))
cbind(Bost = summary(dist(Boston)), df = summary(dist(df))) %>% t()
km <- kmeans(df, centers = 3)
twcss <- sapply(1:20, function(k) kmeans(df, k)$tot.withinss)
qplot(x = 1:20, y = twcss, geom = 'line')
corrplot(cor(df), method = "pie", type = "upper")
p1 <- recordPlot()
p2 <- df %>% mutate(clust = factor(km$cluster)) %>%
gather(., key = "var", value = "value", -c(crim, clust)) %>%
ggplot(aes(value, crim, color = clust)) +
geom_point(shape = 1, size = 1.5, stroke = 1, alpha = .3) +
facet_wrap(~var, scales = "free_x")
multiplot(p2, p2, cols = 2)
p2 <- qplot(df$crim, df$zn)
p1 <- qplot(df$zn, df$zn)
corrplot(cor(df), method = "pie", type = "upper")
p1 <- recordPlot()
p2 <- df %>% mutate(clust = factor(km$cluster)) %>%
gather(., key = "var", value = "value", -c(crim, clust)) %>%
ggplot(aes(value, crim, color = clust)) +
geom_point(shape = 1, size = 1.5, stroke = 1, alpha = .3) +
facet_wrap(~var, scales = "free_x")
multiplot(p1, p2, cols = 2)
multiplot(p1, p1, cols = 2)
class(p2)
class(p1)
p1 <- corrplot(cor(df), method = "pie", type = "upper")
class(p1)
p1 <- corrplot(cor(df), method = "pie", type = "upper") %>% recordPlot()
multiplot(p1, p1, cols = 2)
p1 <- qplot(df$zn, df$zn)
multiplot(p1, p1, cols = 2)
p2 <- df %>% mutate(clust = factor(km$cluster)) %>%
gather(., key = "var", value = "value", -c(crim, clust)) %>%
ggplot(aes(value, crim, color = clust)) +
geom_point(shape = 1, size = 1.5, stroke = 1, alpha = .3) +
facet_wrap(~var, scales = "free_x")
multiplot(p1, p2, cols = 2)
p1 <- corrplot(cor(df), method = "pie", type = "upper") %>% recordPlot()
p2 <- df %>% mutate(clust = factor(km$cluster)) %>%
gather(., key = "var", value = "value", -c(crim, clust)) %>%
ggplot(aes(value, crim, color = clust)) +
geom_point(shape = 1, size = 1.5, stroke = 1, alpha = .3) +
facet_wrap(~var, scales = "free_x") %>% recordPlot()
multiplot(p1, p2, cols = 2)
p1 <- function() {corrplot(cor(df), method = "pie", type = "upper")}
multiplot(p1, p2, cols = 2)
p1
multiplot(p1(), p2, cols = 2)
source('~/.active-rstudio-document', echo=TRUE)
grab_grob <- function(){
gridGraphics::grid.echo()
grid.grab()
}
grab_grob <- function(){
gridGraphics::grid.echo()
grid::grid.grab()
}
corrplot(cor(df), method = "pie", type = "upper")
p1 <- grab_grob()
df %>% mutate(clust = factor(km$cluster)) %>%
gather(., key = "var", value = "value", -c(crim, clust)) %>%
ggplot(aes(value, crim, color = clust)) +
geom_point(shape = 1, size = 1.5, stroke = 1, alpha = .3) +
facet_wrap(~var, scales = "free_x")
p2 <- grab_grob()
gridExtra::grid.newpage()
grid::grid.newpage()
gridExtra::grid.arrange(p1,p2)
grid.arrange()
?grid.arrange()
gridExtra::grid.arrange(p1,p2, ncol = "")
gridExtra::grid.arrange(p1,p2, ncol = 2)
cor(df) %>% orrplot(method = "pie", type = "upper")
p1 <- grab_grob()
cor(df) %>% corrplot(method = "pie", type = "upper")
p1 <- grab_grob()
gridExtra::grid.arrange(p1,p2, ncol = 2)
grid::grid.newpage()
gridExtra::grid.arrange(p1,p2, ncol = 2)
df %>% mutate(clust = factor(km$cluster)) %>%
gather(., key = "var", value = "value", -c(crim, clust)) %>%
ggplot(aes(value, crim, color = clust)) +
geom_point(shape = 1, size = 1.5, stroke = 1, alpha = .3) +
facet_wrap(~var, scales = "free_x")
source("helper_functions.R")
library(magrittr)
library(GGally)
library(stringr)
library(knitr)
library(kableExtra)
library(ggplot2)
library(tidyr)
library(MASS)
library(dplyr)
df <- read.csv(file = "data/human.csv", row.names = 1)
glimpse(df)
df %>% summaryKable() %>%
kable("html", align = "rrr", caption = "Data variable summary") %>%
kable_styling(bootstrap_options = c("hover", "condensed")) %>%
scroll_box(width = "100%")
cor(df, use = "pairwise.complete.obs") %>%
corrplot::corrplot(method = "number", type = "upper",
tl.pos = "td", tl.srt = 25,
tl.offset = 1, tl.cex = .7,
number.cex = .75,
title = "Correlation between study variables",
mar=c(0,0,1,0),
diag = F)
pca <- prcomp(df)
pca %>% summary()
pca
str(pca)
pca$rotation
pca$x
pca$sdev
pca %>% summary()
pca$sdev/sum(pca$sdev)
sqrt(pca$sdev)/sum(sqrt(pca$sdev))
pca$sdev^2/sum(pca$sdev^2)
summary(pca)
summary(pca) %>% str
pca %>% str
pca %>% summary %>% str
summary(pca)$importance
summary(pca)$importance[,3]
summary(pca)$importance[2,]
pca$rotation %*% summary(pca)$importance[2,]
pca$rotation
pca$rotation * summary(pca)$importance[2,]
pca$rotation
pca$rotation * summary(pca)$importance[2,] %>% gather
pca$rotation * summary(pca)$importance[2,]
pca$rotation %*% summary(pca)$importance[2,]
pca$rotation %*% summary(pca)$importance[2,]
pca$rotation * summary(pca)$importance[2,]
summary(pca)$importance[2,] * pca$rotation
pca$rotation
pca %>% summary()
summary(pca)$importance[2,] %>% t()
t(pca$rotation)
t(pca$rotation)* summary(pca)$importance[2,]
colSums(t(pca$rotation)* summary(pca)$importance[2,])
order(colSums(t(pca$rotation)* summary(pca)$importance[2,]))
arrange(colSums(t(pca$rotation)* summary(pca)$importance[2,]))
order(colSums(t(pca$rotation)* summary(pca)$importance[2,]))
sort(colSums(t(pca$rotation)* summary(pca)$importance[2,]))
?sort
sort(colSums(t(pca$rotation)* summary(pca)$importance[2,]), decreasing =T)
pca$rotation %*% summary(pca)$importance[2,]
pca$rotation %*% summary(pca)$importance[2,] %>% sort()
pca$rotation %*% summary(pca)$importance[2,] %>% arrange
as.data.frame(colSums(t(pca$rotation)* summary(pca)$importance[2,]), decreasing =T)
pca$rotation %*% summary(pca)$importance[2,] %>%
```
pca$rotation %*% summary(pca)$importance[2,]
df_scaled <- scale(df)
pca <- prcomp(df_scaled)
pca %>% summary
pca$rotation %*% summary(pca)$importance[2,]
cbind(orig, scaled)
orig <- pca$rotation %*% summary(pca)$importance[2,]
scaled <- pca_scaled$rotation %*% summary(pca_scaled)$importance[2,]
cbind(orig, scaled)
df_scaled <- scale(df)
pca_scaled <- prcomp(df_scaled)
pca_scaled %>% summary
orig <- pca$rotation %*% summary(pca)$importance[2,]
scaled <- pca_scaled$rotation %*% summary(pca_scaled)$importance[2,]
cbind(orig, scaled)
pca <- prcomp(df)
pca %>% summary()
df_scaled <- scale(df)
pca_scaled <- prcomp(df_scaled)
pca_scaled %>% summary
orig <- pca$rotation %*% summary(pca)$importance[2,]
scaled <- pca_scaled$rotation %*% summary(pca_scaled)$importance[2,]
cbind(orig, scaled)
cbind(orig = orig, scaled = scaled)
cbind("orig" = orig, "scaled"" = scaled)
```
cbind("orig" = orig, "scaled" = scaled)
cbind(orig, scaled) %>% as.data.frame()
cbind(orig, scaled) %>% as.data.frame(names = c("orig", "scaled")
```
cbind(orig, scaled) %>% as.data.frame(names = c("orig", "scaled"))
as.data.frame()
?as.data.frame()
cbind(orig, scaled) %>% as.data.frame(col.names = c("orig", "scaled"))
cbind(orig, scaled) %>% as.data.frame(col.names = names("orig", "scaled"))
cbind(orig, scaled) %>% as.data.frame(col.names = c("orig", "scaled"))
cbind(orig, scaled) %>% data.frame(col.names = c("orig", "scaled"))
as.
cbind(orig, scaled) %>% as.data.frame(col.names = c("orig", "scaled"))
a <- cbind(orig, scaled)
a
str()
str(a
)
names(a)
colnames(a)
a <- cbind(orig, scaled) %>% as.data.frame(.)
str(a)
a <- cbind(orig, scaled)
str(a)
?cbind
a <- cbind(orig, scaled) %>% as.data.frame()
str(a)
?as.data.frame
a <- cbind(orig, scaled) %>% as.data.frame(col.names = c("jee", "joo") )
str(a)
names(a)
a <- cbind(orig, scaled) %>% data.frame(col.names = c("jee", "joo") )
str(a)
names(a)
a <- cbind(orig, scaled) %>% as.data.frame(col.names = c("jee", "joo") )
str(a)
names(a)
a <- cbind(orig, scaled) %>% as.data.frame(colnames = c("jee", "joo") )
str(a)
names(a)
a <- cbind(orig, scaled) %>% as.data.frame(colnames = col.names = names(x))
a <- cbind(orig, scaled) %>% as.data.frame(colnames = col.names = names(c("joo", "jee")))
a <- cbind(orig, scaled) %>%
as.data.frame(colnames = col.names = names(c("joo", "jee")))
a <- cbind(orig, scaled) %>%
as.data.frame(col.names = names(c("joo", "jee")))
str(a)
cbind(as.data.frame(orig), as.data.frame(scaled))
cbind(orig = as.data.frame(orig), as.data.frame(scaled))
as.data.frame(orig)
as.data.frame(orig, col.names = "jee")
cbind(orig, scaled) %>%
as.data.frame(dimnames = list(NULL, c("orig", "scaled")))
cbind(orig, scaled) %>%
as.data.frame(dimnames = list(c("orig", "scaled")))
cbind(orig, scaled) %>%
as.data.frame(dimnames = list(c("orig", "scaled")))
cbind(orig, scaled) %>% class
cbind(orig, scaled) %>%
as.data.frame(dimnames = list(c("orig", "scaled")))
cbind(orig, scaled) %>% rename(asd)
cbind(orig, scaled) %>% data.frame()
cbind(orig, scaled) %>% data.frame() %>% rename(orig = X1, scaled = X2)
orig <- pca$rotation %*% summary(pca)$importance[2,]
scaled <- pca_scaled$rotation %*% summary(pca_scaled)$importance[2,]
cbind(orig, scaled) %>% data.frame() %>% rename(orig = X1, scaled = X2)
orig <- pca$rotation %*% summary(pca)$importance[2,] %>% round(3)
scaled <- pca_scaled$rotation %*% summary(pca_scaled)$importance[2,] %>% round(3)
cbind(orig, scaled) %>% data.frame() %>% rename(orig = X1, scaled = X2)
orig <- pca$rotation %*% summary(pca)$importance[2,] %>%
round(3)
scaled <- pca_scaled$rotation %*% summary(pca_scaled)$importance[2,] %>%
round(3)
orig <- pca$rotation %*% summary(pca)$importance[2,]
scaled <- pca_scaled$rotation %*% summary(pca_scaled)$importance[2,]
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3)
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t
summary(pca)
summary(pca)$rotation
summary(pca_scaled)$importance[2,]
rbind(summary(pca)$importance[2,], summary(pca_scaled)$importance[2,])
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t
rbind(summary(pca)$importance[2,], summary(pca_scaled)$importance[2,]) %>%
as.data.frame(row.names(c("orig", "scaled")))
rbind(summary(pca)$importance[2,], summary(pca_scaled)$importance[2,]) %>%
as.data.frame(row.names(c("orig", "scaled")))
rbind(summary(pca)$importance[2,], summary(pca_scaled)$importance[2,]) %>%
as.data.frame(row.names = c("orig", "scaled"))
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t
rbind(summary(pca)$importance[2,], summary(pca_scaled)$importance[2,]) %>%
as.data.frame(row.names = c("orig", "scaled"))
?biplot
biplot(pca, choices = 1:2, cex = c(1,1))
biplot(pca, choices = 1:2, cex = c(2,1))
biplot(pca, choices = 1:2, cex = c(.5,1))
biplot(pca, choices = 1:2, cex = c(.5,1))
biplot(pca_scaled, choices = 1:2, cex = c(.5,1))
pca_scaled %>% summary
pca$rotation
orig
biplot(pca, choices = 1:2, cex = c(.5,1))
df_scaled <- scale(df)
pca_scaled <- prcomp(df_scaled)
biplot(pca_scaled, choices = 1:2, cex = c(.5,1))
orig <- pca$rotation %*% summary(pca)$importance[2,]
scaled <- pca_scaled$rotation %*% summary(pca_scaled)$importance[2,]
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t
glimpse(df)
summary(df)
rbind(summary(pca)$importance[2,], summary(pca_scaled)$importance[2,]) %>%
as.data.frame(row.names = c("orig", "scaled"))
summary(pca_scaled)$importance[3,])
summary(pca_scaled)$importance[3,])
summary(pca_scaled)$importance[3,]
cor(df_scaled, use = "pairwise.complete.obs") %>%
corrplot::corrplot(method = "number", type = "upper",
tl.pos = "td", tl.srt = 25,
tl.offset = 1, tl.cex = .7,
number.cex = .75,
title = "Correlation between study variables",
mar=c(0,0,1,0),
diag = F)
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t %>% rowsum()
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t %>% rowsum()
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t %>% rowsums
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t %>% rowSums
as.data.frame(colSums(t(pca$rotation) * summary(pca)$importance[2,]), decreasing =T)
colSums(t(pca$rotation)
df2 <- data.frame()
for(i in 1:ncol(df)) {
for(j in i:ncol(df)){
a <- data.frame(y = df[[j]],
x = df[[i]],
clust = factor(km$cluster),
name = paste(names(df[i]),names(df[j]), sep=":"))
df2 <- rbind(df2, a)
}
}
ggplot(df2) + geom_point(aes(x,y, color = clust)) + facet_wrap(~name)
t(pca$rotation)
summary(pca)$importance[2,])
summary(pca)$importance[2,]
t(pca$rotation) * summary(pca)$importance[2,]
abs(t(pca$rotation) * summary(pca)$importance[2,])
colSums(abs(t(pca$rotation) * summary(pca)$importance[2,]))
t(pca$rotation) * summary(pca)$importance[2,] %>% abs %>% colSums
t(pca$rotation) * summary(pca)$importance[2,] %>% abs %>% colSums()
t(pca$rotation) * summary(pca)$importance[2,] %>% abs() %>% colSums()
(t(pca$rotation) * summary(pca)$importance[2,]) %>% abs() %>% colSums()
(t(pca$rotation) * summary(pca)$importance[2,]) %>% abs() %>% colSums()
orig <- abs(pca$rotation) %*% summary(pca)$importance[2,]
scaled <- abs(pca_scaled$rotation) %*% summary(pca_scaled)$importance[2,]
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t %>% rowSums
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t
(t(pca$rotation) * summary(pca)$importance[2,]) %>% abs() %>% colSums()
(t(pca$rotation) * summary(pca)$importance[2,]) %>%
abs() %>% colSums() %>% round(3)
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t
cbind(orig, scaled, a) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t
a <- (t(pca$rotation) * summary(pca)$importance[2,]) %>%
abs() %>% colSums() %>% round(3)
cbind(orig, scaled, a) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t
cbind(orig, scaled, a) %>% data.frame() %>%
rename(orig = X1, scaled = X2, a = a) %>% round(3) %>% t
a <- (t(pca$rotation) * summary(pca)$importance[2,]) %>%
abs() %>% colSums() %>% round(3)
a
cbind(orig, scaled, a) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t %>% rbind(a)
orig <- abs(pca$rotation) %*% summary(pca)$importance[2,]
scaled <- abs(pca_scaled$rotation) %*% summary(pca_scaled)$importance[2,]
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t %>% rbind(a)
scaled <- abs(pca_scaled$rotation) %*% summary(pca_scaled)$importance[2,]
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t
rbind(summary(pca)$importance[2,], summary(pca_scaled)$importance[2,]) %>%
as.data.frame(row.names = c("orig", "scaled"))
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t
biplot(pca_scaled, choices = 1:2, cex = c(.5,1))
pca_scaled %>% summary
pca
pca_ca
pca_sca
pca_scaled
pca_scaled %>% summary
pca_scaled$rotation
pca_scaled$rotation[1]
pca_scaled$rotation[1,]
pca_scaled$rotation[,1]
pca_scaled$rotation[1,]
abs(pca_scaled$rotation[1,])*summary(pca_scaled)$importance[2,)
pca_scaled %>% summary
```
abs(pca_scaled$rotation[1,])*
summary(pca_scaled)$importance[2,)
pca_scaled %>% summary
```
summary(pca_scaled)$importance[2,}
pca_scaled %>% summary
```
summary(pca_scaled)$importance[2,]
abs(pca_scaled$rotation[1,])
abs(pca_scaled$rotation[1,]) * summary(pca_scaled)$importance[2,]
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t
rbind(summary(pca)$importance[2,], summary(pca_scaled)$importance[2,]) %>%
as.data.frame(row.names = c("orig", "scaled"))
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t
abs(pca_scaled$rotation[1,]) * summary(pca_scaled)$importance[2,]
abs(pca_scaled$rotation[1,])
summary(pca_scaled)$importance[2,]
0.37*0.49
abs(pca_scaled$rotation[1,]) * summary(pca_scaled)$importance[2,]
(abs(pca_scaled$rotation[1,]) * summary(pca_scaled)$importance[2,]) %>% sum
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t
pca_scaled %>% summary
pca_scaled
pca_scaled %>% summary
orig <- abs(pca$rotation) %*% summary(pca)$importance[2,]
scaled <- abs(pca_scaled$rotation) %*% summary(pca_scaled)$importance[2,]
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t
rbind(summary(pca)$importance[2,], summary(pca_scaled)$importance[2,]) %>%
as.data.frame(row.names = c("orig", "scaled"))
rbind(summary(pca)$importance[3,], summary(pca_scaled)$importance[3,]) %>%
as.data.frame(row.names = c("orig", "scaled"))
orig <- abs(pca$rotation) %*% summary(pca)$importance[2,]
scaled <- abs(pca_scaled$rotation) %*% summary(pca_scaled)$importance[2,]
cbind(orig, scaled) %>% data.frame() %>%
rename(orig = X1, scaled = X2) %>% round(3) %>% t
mca %>% plot(invisible=c("ind"))
library(FactoMineR)
data(tea)
df <- tea
mca <- df %>% select(breakfast, friends, resto, Tea, Sport) %>%
MCA(graph = FALSE)
mca %>% summary
mca %>% plot(invisible=c("ind"))
biplot(pca_scaled, choices = 1:2, cex = c(.25,.5))
# Chunk 1
#Hidden
source("helper_functions.R")
library(magrittr)
library(GGally)
library(stringr)
library(knitr)
library(kableExtra)
library(ggplot2)
library(tidyr)
library(MASS)
library(dplyr)
